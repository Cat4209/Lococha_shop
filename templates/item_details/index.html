{% extends 'wrapper.html' %}
{% block header %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<link rel="stylesheet" href="../../static/item_details/css/style.css">
{% endblock %}
{% block body %}
{% if current_user in post.users %}
   {%  with success = get_flashed_messages(category_filter=["success"]) %}
       {% if success %}
        <div class="alert alert-success">{{success[0]}}</div>
        {% endif %}
    {% endwith %}
{% endif %}
<div class="main_section">
    <div class="main_section_container">
        <div class="main_section_left">
            <div class="swiper-container gallery-top">
            <div class="swiper-wrapper">
              <div class="swiper-slide" style="background: url(../../static/uploads/{{ post.image }}) no-repeat center center; background-size: cover;"></div>
              {% if post.image_2 %}
              <div class="swiper-slide" style="background: url(../../static/uploads/{{ post.image_2 }}) no-repeat center center; background-size: cover;"></div>
              {% endif %}
              {% if post.image_3 %}
              <div class="swiper-slide" style="background: url(../../static/uploads/{{ post.image_3 }}) no-repeat center center; background-size: cover;"></div>
              {% endif %}
            </div>
          </div>
          <div class="swiper-container gallery-thumbs">
            <div class="swiper-wrapper">
              <div class="swiper-slide" style="background: url(../../static/uploads/{{ post.image }}) no-repeat center center; background-size: cover;"></div>
              {% if post.image_2 %}
              <div class="swiper-slide" style="background: url(../../static/uploads/{{ post.image_2 }}) no-repeat center center; background-size: cover;"></div>
              {% endif %}
              {% if post.image_3 %}
              <div class="swiper-slide" style="background: url(../../static/uploads/{{ post.image_3 }}) no-repeat center center; background-size: cover;"></div>
              {% endif %}
            </div>
          </div>
        </div>
        <div class="main_section_right">
            <div class="post_title_rating">
                <div class="post_title">{{ post.name }}</div>
                <div class="post_rate">({{pages.items|length}} reviews)</div>
            </div>
            <div class="post_price_active">
                <div class="post_price">${{ post.price }}</div>
                <div class="post_active">
                {% if post.isActive == 'on' %}
                    <span class="active">Instock</span>
                {% else %}
                    <span class="missing">Missing</span>
                {% endif %}
                </div>
            </div>
            <div class="description">
                <span class="description_text">Description: </span><span class="description_post">{{ post.description }}</span> 
            </div>
            <div class="model">
                <span class="model_text">The model is wearing size:  </span>
                <span class="model_size">S </span>
                <span class="model_text">- Model hight: </span>
                <span class="model_size">185cm</span>
            </div>
            <form action="/cart_add" class="form" method="post">
                <div class="colors_row">
                    {% if post.color %}
                        <div class="color color_1">
                            <label>
                                <input value="{{ post.color }}" type="radio" name="color" required>
                                <span style="cursor: pointer;" class="color_text">{{ post.color }}</span>
                                <span class="after_input" style="background-color: {{ post.color }};;border: 1px solid #000;"><i class="fas fa-check"></i></span>
                            </label>
                        </div>
                    {% endif %}
                    {% if post.color_1 %}
                        <div class="color color_2">
                            <label>
                                <input value="{{ post.color_1 }}" type="radio" name="color">
                                <span style="cursor: pointer;" class="color_text">{{ post.color_1 }}</span>
                                <span class="after_input" style="background-color: {{ post.color_1 }};border: 1px solid #000;"><i class="fas fa-check"></i></span>
                            </label>
                        </div>
                    {% endif %}
                    {% if post.color_2 %}
                        <div class="color color_3">
                            <label>
                                <input value="{{ post.color_2 }}" type="radio" name="color">
                                <span style="cursor: pointer;" class="color_text">{{ post.color_2 }}</span>
                                <span class="after_input" style="background-color: {{ post.color_2 }};border: 1px solid #000;"><i class="fas fa-check"></i></span>
                            </label>
                        </div>
                    {% endif %}
                    {% if post.color_3 %}
                        <div class="color color_4">
                            <label>
                                <input value="{{ post.color_3 }}" type="radio" name="color">
                                <span style="cursor: pointer;" class="color_text">{{ post.color_3 }}</span>
                                <span class="after_input" style="background-color: {{ post.color_3 }};border: 1px solid #000;"><i class="fas fa-check"></i></span>
                            </label>
                        </div>
                    {% endif %}
                </div>
                <div class="sizes_row">
                   {% if post.os == 'on' %}
                    <div class="form-group">
                        <input type="radio" class="form-control size" value="os" autocomplete="off" name="size" id="os" required>
                        <label for="os" class="control-label size-label">OS</label>
                    </div>
                    {% endif %}
                    {% if post.xs == 'on' %}
                    <div class="form-group">
                        <input type="radio" class="form-control size" value="xs" autocomplete="off" name="size" id="xs" required>
                        <label for="xs" class="control-label size-label">XS</label>
                    </div>
                    {% endif %}
                    {% if post.s == 'on' %}
                    <div class="form-group">
                        <input type="radio" class="form-control size" value="s" autocomplete="off" name="size" id="s" required>
                        <label for="s" class="control-label size-label">S</label>
                    </div>
                    {% endif %}
                    {% if post.m == 'on' %}
                    <div class="form-group">
                        <input type="radio" class="form-control size" value="m" autocomplete="off" name="size" id="m" required>
                        <label for="m" class="control-label size-label">M</label>
                    </div>
                    {% endif %}
                    {% if post.l == 'on' %}
                    <div class="form-group">
                        <input type="radio" class="form-control size" value="l" autocomplete="off" name="size" id="l" required>
                        <label for="l" class="control-label size-label">L</label>
                    </div>
                    {% endif %}
                    {% if post.xl == 'on' %}
                    <div class="form-group">
                        <input type="radio" class="form-control size" value="xl" autocomplete="off" name="size" id="xl" required>
                        <label for="xl" class="control-label size-label">XL</label>
                    </div>
                    {% endif %}
                    {% if post.xxl == 'on' %}
                    <div class="form-group">
                        <input type="radio" class="form-control size" value="xxl" autocomplete="off" name="size" id="xxl" required>
                        <label for="xxl" class="control-label size-label">XXL</label>
                    </div>
                    {% endif %}
                </div>
                <div class="guide mt-2">
                    <a href="#" role="alert">Guide</a>
                </div>
                <div class="number_wish">
                    <div class="number_box">
                        <div class="number_box_minus number_box_controlers"><i class="fas fa-minus"></i></div>
                        <div class="number_box_input"><input class="input_number" min="1" type="number" value="1" name="count"></div>
                        <div class="number_box_plus number_box_controlers"><i class="fas fa-plus"></i></div>
                    </div>
                    <div class="wish_box">
                      {% if not current_user.is_authenticated %}
                       <a href="/login">
                            <label class="wish_label">
                                <div class="heart">
                                <i class="far fa-heart"></i>
                                </div>
                                <div class="wish_text">
                                    Add to wishlist
                                </div>
                            </label>
                        </a>
                        {% else %}
                        <a href="{{url_for('add_wish', slug=post.slug)}}">
                            <label class="wish_label">
                                <div class="heart">
                                 {% if post_users_len > 0 %}
                                  {% for user in post.users.all() %}
                                      {% if user.id|int == current_user.get_id()|int %}
                                         <i class="fas fa-heart" style="color: red;"></i>
                                        {% else %}
                                        <i class="far fa-heart"></i>
                                      {% endif %}
                                  {% endfor %}
                                  {% else %}
                                      <i class="far fa-heart"></i>
                                  {% endif %}
                                </div>
                                <div class="wish_text">
                                    Add to wishlist
                                </div>
                            </label>
                        </a>
                        {% endif %}
                    </div>
                </div>
                <div class="button_container">
                    <button type="submit" name="Product_done" role="button" class="button_form">Add to Cart</button>
                </div>
                <input type="hidden" name="post_slug" value="{{post.slug}}">
            </form>
            <div class="tags">
                
            </div>
            <div class="sku_links">
                <div class="share_footer">
                    <div data-network="facebook" class="st-custom-button"><i class="fab fa-facebook-f"></i></div>
                    <div data-network="twitter" class="st-custom-button"><i class="fab fa-twitter"></i></div>
                    <div data-network="whatsapp" class="st-custom-button"><i class="fab fa-whatsapp"></i></div>
                    <div data-network="email" class="st-custom-button"><i class="far fa-envelope"></i></div>
                </div>
            </div>
            <ul class="nav nav-tabs" id="myList" role="tablist">
                <li class="active"><a data-toggle="tab" href="#home" role="tab">Description</a></li>
                <li><a data-toggle="tab" href="#messages" role="tab">Reviews</a></li>
            </ul>
            <div class="tab-content">
              <div class="tab-pane active fade in" id="home" role="tabpanel">
                  <div class="description" style="line-height: 1.8em;">
                    <span class="description_text">Description: </span><span class="description_post">{{ post.description }}</span> 
                </div>
              </div>
                <div class="tab-pane fade" id="messages" role="tabpanel">
                   <div class="messages">
                       {% for message in pages.items %}
                        <div class="message_container">
                           <div class="message_date">{{message.month}} {{ message.created.day }}, {{ message.created.year }}</div>
                           <div class="message_username">{{ message.user_name }}</div>
                           <div class="message_text">{{ message.review }}</div>
                           <div class="message_rating">
                            {% for star in range(message.rating) %}
                               <span class="star">★</span>
                            {% endfor %}
                           </div>
                        </div>
                        {% endfor %}
                        {% if pages.pages > 1 %}
                        <div class="message_controllers">
                            <ul class="pagination">
                            <li class="page-item">
                              <a class="page-link" href="/shop/{{post.slug}}/?page={{pages.prev_num}}" {% if not pages .has_prev %} style="display: none;" {% endif %}>
                                <span aria-hidden="true">&laquo;</span>
                              </a>
                            </li>

                            {% for page in pages.iter_pages() %}
                                <li  {% if page == pages.page %} class="page-item active" {% else %} class="page-item" {% endif %}><a class="page-link" href="/shop/{{post.slug}}/?page={{page}}">{{page}}</a></li>
                            {% endfor %}

                            <li class="page-item">
                              <a class="page-link" href="/shop/{{post.slug}}/?page={{pages.next_num}}" {% if not pages.has_next %} style="display: none;" {% endif %}>
                                <span aria-hidden="true">&raquo;</span>
                              </a>
                            </li>
                          </ul>
                        </div>
                        {% endif %}
                   </div>
                    <div class="comments_title">
                        Add your review
                    </div>
                    {% if current_user.is_authenticated %}
                    <form action="" class="form form_2 mt-4" id="comment_form" autocomplete="off" novalidate>
                        <div id="post_slug">{{ post.slug }}</div>
                       <div class="rate mb-4">
                            <div class="rate_title">Vote: </div>
                            <div class="rate-group ml-3">
                                <input class="form-control input_rate_star" type="radio" id="5" name="vote" value="5">
                                <label class="control-label label_rating" for="5"></label>
                                <input class="form-control input_rate_star" type="radio" id="4" name="vote" value="4">
                                <label class="control-label label_rating" for="4"></label>
                                <input class="form-control input_rate_star" type="radio" id="3" name="vote" value="3">
                                <label class="control-label label_rating" for="3"></label>
                                <input class="form-control input_rate_star" type="radio" id="2" name="vote" value="2">
                                <label class="control-label label_rating" for="2"></label>
                                <input class="form-control input_rate_star" type="radio" id="1" name="vote" value="1">
                                <label class="control-label label_rating" for="1"></label>
                            </div>
                       </div>
                        <div class="form-group mb-4">
                            <label class="control-label mb-3" for="name">Your Name</label>
                            <input class="form-control" name="name" id="name" type="text" required>
                        </div>
                        <div class="form-group mb-4">
                            <input class="form-control" value="{{user.email}}" name="email" id="email" type="hidden" required>
                        </div>
                        <div class="form-group">
                            <label class="control-label mb-3" for="review">Your Review</label>
                            <textarea name="review" maxlength="5000" id="review" required></textarea>
                        </div>
                        <div class="form-group">
                            <div class="button_container_2">
                                <button type="submit" name="Message_done" role="button" class="button_form" id="button_comment">Add Comment</button>
                            </div>
                        </div>
                    </form>
                    {% else %}
                    <div class="no_m">You must login or register to send messages.</div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
<div class="third_section">
    <div class="third_section_container">
       <div class="third_section_title">
           Related products
       </div>
        <div class="related_products_row">
           {% for product in posts %}
            <div class="six_section_card">
                <div class="six_section_card_header">
                    <a href="{{url_for('item_details', slug=product.slug)}}">
                    <div class="six_section_header_image" style="background: url(../../static/uploads/{{product.image}}) no-repeat center center; background-size: cover;"></div>
                    </a>
                    <div class="tags">
                       {% for tag in product.tags %}
                           {% if tag.title == "New" %}
                                <div class="tag tag_new"><a href="/product_list?tag=New">NEW</a></div>
                           {% endif %}
                            {% if tag.title == "Sale" %}
                               <div class="tag tag_sale"><a href="/product_list?tag=Sale">SALE</a></div>
                           {% endif %}
                            {% if tag.title == "Hot" %}
                                <div class="tag tag_hot"><a href="/product_list?tag=Hot">HOT</a></div>
                           {% endif %}
                       {% endfor %}
                    </div>
                    <div class="view_buy view_buy_1">
                        <div class="vb quick_buy"><a href=""><svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-handbag" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 1a2 2 0 0 0-2 2v2h4V3a2 2 0 0 0-2-2zm3 4V3a3 3 0 1 0-6 0v2H3.361a1.5 1.5 0 0 0-1.483 1.277L.85 13.13A2.5 2.5 0 0 0 3.322 16h9.356a2.5 2.5 0 0 0 2.472-2.87l-1.028-6.853A1.5 1.5 0 0 0 12.64 5H11zm-1 1v1.5a.5.5 0 0 0 1 0V6h1.639a.5.5 0 0 1 .494.426l1.028 6.851A1.5 1.5 0 0 1 12.678 15H3.322a1.5 1.5 0 0 1-1.483-1.723l1.028-6.851A.5.5 0 0 1 3.36 6H5v1.5a.5.5 0 0 0 1 0V6h4z"/>
                            </svg></a></div>
                        <div class="vb quick_view"><a href=""><i class="fas fa-eye"></i></a></div>
                        <div class="edit_post">
                            <a href="#"><i class="far fa-edit"></i></a>
                        </div>
                    </div>
                    <div class="colors">
                        <div class="color color"  style="background-color: {{product.color}};"></div>
                        {% if product.color_1 %}
                        <div class="color color_1" style="background-color: {{product.color_1}};"></div>
                        {% endif %}
                        {% if product.color_2 %}
                        <div class="color color_2" style="background-color: {{product.color_2}};"></div>
                        {% endif %}
                        {% if product.color_3 %}
                        <div class="color color_3" style="background-color: {{product.color_3}};"></div>
                        {% endif %}
                    </div>
                </div>
                <div class="six_section_card_footer mt-3">
                    <div class="swiper_2_article">
                        <div class="swiper_2_title"><a href="{{url_for('item_details', slug=product.slug)}}">{{ product.name }}</a></div>
                        <div class="swiper_2_like">
                        {% if not current_user.is_authenticated %}
                            <a href="/login">
                                <div class="heart">
                                        <i class="far fa-heart"style="color: #2e2e2e;"></i>
                                </div>
                            </a>
                            {% else %}
                            <a href="{{url_for('add_wish', slug=post.slug)}}">
                                <div class="heart">
                                    {% if product.users.all()|length > 0 %}
                                        {% for user in product.users.all() %}
                                        {% if user.id|int == current_user.get_id()|int %}
                                        <i class="fas fa-heart" style="color: red;"></i>
                                        {% else %}
                                        <i class="far fa-heart" style="color: #2e2e2e;"></i>
                                        {% endif %}
                                        {% endfor %}
                                    {% else %}
                                          <i class="far fa-heart" style="color: #2e2e2e;"></i>
                                      {% endif %}
                                    </div>
                                </a>     
                        {% endif %}
                        </div>
                    </div>
                    <div class="swiper_2_price mt-1">
                        <div class="new_price">${{ product.price }}</div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

{% endblock %}
{% block footer %}
<script src="https://cdn.socket.io/socket.io-3.0.1.min.js"></script>
<script src="../../static/item_details/js/script.js"></script>
{% endblock %}